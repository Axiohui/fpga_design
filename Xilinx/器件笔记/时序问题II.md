**电磁干扰和引脚驱动电流约束**

**时序问题的表现:**

1. 正常的传输会突然停止，并且无法自动恢复，直到手工给该芯片复位。
2. 传输停止的时刻有一定的规律，即传输某一地址范围的数据时问题反复出现，在传输其他地址范围的数据时，问题不出现。
3. FPGA接口电路 在与官方的某些器件直接连接时 没有该问题出现，可以正常连续运行。

**时序问题的解决:**

在确认了EMI问题后，下一步就是怎样解决问题。
EMI的发生需要三个条件：干扰源、传播媒介、易受干扰的受害者。在当时的情况下，这三个条件中，唯一可控的就是干扰源——FPGA驱动的数据总线。

信号跳变与EMI的联系：信号边沿的上升和下降时间：时间越短，EMI越强。
影响FPGA输出信号的上升时间的因素有三个： 

1. I/O标准（I/O Standard），因标准而异。  
2. 驱动电流强度（Current Strength）。电流越大，上升速度越快。电流从24mA到4mA不等。
3. 信号坡度（Slew Rate），分为快慢两种。 
4. 输出延时（Output Delay），加入延时可以减缓上升速度。

在Assignment Editor中对上述因素进行了设置，采用3.3V LVTTL + 4mA + Slow Slew Rate + Output Delay设置方式，使信号上升时间达到最大，产生的EMI最小，问题也就解决。

即使采用了最佳的约束，FPGA的输出信号上升时间仍然与硬盘驱动的信号存在很大的差距，这也是IDE硬盘与转接电路板连接不会出现问题的原因。硬盘的接口芯片应该采取了专门的处理，在芯片的制造工艺上采取了措施。这一点无从考证。

**避免和解决该问题的方法：**

1. **传输信号的转换速率**，这一点在设计电路板时应加以考虑和处理，在FPGA的约束上也要加以注意。   
2. EMI问题的定位比较困难，尽量在设计阶段解决，不要遗留到调试阶段。  
3. **特定数据模式或特定地址传输导致的问题，需要考虑接口的EMI问题。**因为接口是没有智能的，不会识别和挑剔数据内容。  
4. **FPGA的引脚驱动能力会影响EMC，在某些情况下导致EMI问题。当发生EMI问题时，约束电流强度是一种可行的解决方法**。  
5. 在调试过程中，对于小概率发生的事件可以采用多个实验并行进行的方式缩短实验时间。   
6. 对实验现象的解释需要大胆猜测，小心论证。 

**jitter就是一种抖动：**

具体如何解释呢？让我们来看一个例子。假如你有个女友，你希望她每天晚上下班之后7点来找你，而有的时候她6:30到，有的时候是7:23，有的时候也许是下一天。这种时间上的不稳定就是jitter。
例如：

	Clock Uncertainty:              0.035ns  ((TSJ^2 + TIJ^2)^1/2 + DJ) / 2 + PE
    	Total System Jitter (TSJ):  0.070ns
    	Total Input Jitter (TIJ):   0.000ns
   		Discrete Jitter (DJ):       0.000ns
   		Phase Error (PE):           0.000ns

**电气干扰领域：**

1. EMI(Electro Magnetic Interference)直译是"电磁干扰"。所谓"干扰"，指设备受到干扰后性能降低 ； 对设备产生干扰的干扰源。
2. EMS（Electro Magnetic Susceptibility）直译是"电磁敏感度"。其意是指由于电磁能量造成性能下降的容易程度。为通俗易懂，我们将电子设备比喻为人，将电磁能量比做感冒病毒，敏感度就是是否易患感冒。如果不易患感冒，说明免疫力强，也就是英语单词Immunity，即抗电磁干扰性强。
3. EMC（Electro Magnetic Compatibility）直译是"电磁兼容性"。意指设备所产生的电磁能量既不对其它设备产生干扰，也不受其他设备的电磁能量干扰的能力。特别是与设计意图相反的电磁现象，都应看成是EMC问题。
4. EMC 包括两个方面的要求：一方面是指设备在正常运行过程中对所在环境产生的电磁干扰不能超过一定的限值；另一方面是指器具对所在环境中存在的电磁干扰具有一定程度的抗扰度，即电磁敏感性。 
